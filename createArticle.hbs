<form id="create-article-form">
    <input type="text" id="title" placeholder="Title" required/>
    <input type="text" id="summary" placeholder="Summary" required/>
    <textare id="content" placeholder="Content" required></textare>
    <select id="category" required>
        <option value="">Select Category</option>
        <option value="business">Business</option>
        <option value="technology">Technology</option>
        <!-- Add more categories as needed -->
    </select>
    <input type="text" id="tags" placeholder="Tags"/>
    <button type="submit">Submit article</button>
</form>

<script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js"></script>
<script>
    tinymce.init({
        selector: '#content', // Target the textarea with id 'content'
        plugins: 'lists link iamge preview',
        toolbar: 'undo redo | styleselect | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | link image | preview',
        height: 300,
    });

    document.getElementById('create-article-form').addEventListener('submit', async function (e) {
        e.preventDefault();  // Prevent the default form submission

        const title = document.getElementById('title').value;
        const summary = document.getElementById('summary').value;
        const content = tinymce.get('content').getContent();
        const category = document.getElementById('category').value;
        const tags = document.getElementById('tags').value.split(',').map(tag => tag.trim());

        const articleData = {
            title,
            summary,
            content,
            category,
            tags,
        };

        try {
            const respone = await fetch('/api/writer', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming you store the token in local storage
                },
                body: JSON.stringify(articleData),
            });

            if (respone.ok) {
                const result = await respone.json();
                alert('Article created successfully!');
                document.getElementById('create-article-form').reset();
                tinymce.get('content').setContent('');
            } else {
                const error = await respone.json();
                alert(`Error: ${error.message}`);
            }
        } catch (error) {
            console.error('Error creating article:', error);
            alert('An error occured while creating the article.');
        }
    });
</script>