<div id="draft-articles">
    <h2>Draft Articles</h2>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="articles-list">
            <!-- Articles will be populated here -->
        </tbody>
    </table>
</div>

<script>
    async function fetchDraftArticles() {
        try {
            const response = await fetch('/api/editor/drafts', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming you store the token in local storage
                },
            });

            if (response.ok) {
                const articles = await response.json();
                const articlesList = document.getElementById('articles-list');
                articlesList.innerHTML = '';

                articles.forEach(article => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${article.title}</td>
                        <td>${article.author}</td>
                        <td>${article.status}</td>
                        <td>
                            <button onclick="approveArticle('${article._id}')">Approve</button>
                            <button onclick="rejectArticle('${article._id}')">Reject</button>
                        </td>
                    `;
                    articlesList.appendChild(row);
                });
            } else {
                console.error('Failed to fetch draft articles');
            }
        } catch (error) {
            console.error('Error fetching draft articles:', error);
        }
    }

    async function approveArticle(articleID) {
        try {
            const response = await fetch(`/api/editor/approve/${articleID}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming you store the token in local storage
                },
            });

            if (response.ok) {
                alert('Article approved successfully!');
                fetchDraftArticles();
            } else {
                const error = await response.json();
                alert(`Error: ${error.message}`);
            }
        } catch (error) {
            console.error('Error approving article:', error);
        }
    }

    async function rejectArticle(articleID) {
        const reason = prompt("Please enter the reason for rejection:");
        if (!reason) {
            alert("Rejection reason is required.");
            return;
        }

        try {
            const response = await fetch(`/api/editor/reject/${articleID}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming you store the token in local storage
                },
                body: JSON.stringify({ reason }),
            });

            if (response.ok) {
                alert('Article rejected successfully!');
                fetchDraftArticles();
            } else {
                const error = await response.json();
                alert(`Error: ${error.message}`);
            }
        } catch (error) {
            console.error('Error rejecting article:', error);
        }
    }

    document.addEventListener('DOMContentLoaded', fetchDraftArticles);
</script>